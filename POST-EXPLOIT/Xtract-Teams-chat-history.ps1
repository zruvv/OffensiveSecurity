<#
    .SYNOPSIS
        Extracts Microsoft Teams Chat History.

    .DESCRIPTION
        -  
        -  Run this locally and in the context of the local user


    .NOTES
        File Name: Xtract_Teams-chat-history.ps1
        Last Updated: 8/24/2021
        Author: Mike Wurz
#>

$firstString = "<div"
$secondString = "div>"

$importPath = "$Env:AppData\Microsoft\Teams\IndexedDB\https_teams.microsoft.com_0.indexeddb.leveldb\*.log"
$text = Get-Content $importPath
$pattern = "(?<=$firstString).*?(?=$secondString)"

$output = [regex]::Matches($text,$pattern).value
$hash = @{} 
Write-Output $output | %{if($hash.$_ -eq $null) { $_ }; $hash.$_ = 1} 